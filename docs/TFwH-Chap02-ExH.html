<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>TFwH.Chap02.ExH</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_TFwH-Chap02-ExH.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/TFwH.Chap02.ExH.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">tfwh-0.3.2.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">TFwH.Chap02.ExH</p></div><div id="description"><p class="caption">Description</p><div class="doc"><h1>&#31532;2&#31456; &#32244;&#32722;&#21839;&#38988; H</h1><ul><li><p><code>addSum :: CIN -&gt; CIN</code> &#12434;&#27083;&#25104;&#12379;&#12424;</p><pre>type CIN = String

addSum :: CIN -&gt; CIN
addSum cin = cin ++ show (n <code><a href="../base-4.9.1.0/Prelude.html#v:div">div</a></code> 10) ++ show (n <code><a href="../base-4.9.1.0/Prelude.html#v:mod">mod</a></code> 10)
             where
               n = sum (map getDigit cin)

getDigit :: Char -&gt; Int
getDigit c = read [c]
</pre></li></ul><ul><li><p>&#35672;&#21029;&#30058;&#21495;&#12364;&#27491;&#12375;&#12356;&#12363;&#12393;&#12358;&#12363;&#12434;&#21028;&#23450;&#12377;&#12427;&#38306;&#25968; <code>valid :: CIN -&gt; Bool</code> &#12434;&#27083;&#25104;&#12379;&#12424;</p><pre>valid :: CIN -&gt; Bool
valid cin = cin == addSum (take 8 cin)
</pre></li></ul></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:CIN">CIN</a> = <a href="../base-4.9.1.0/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:addSum">addSum</a> :: <a href="TFwH-Chap02-ExH.html#t:CIN">CIN</a> -&gt; <a href="TFwH-Chap02-ExH.html#t:CIN">CIN</a></li><li class="src short"><a href="#v:valid">valid</a> :: <a href="TFwH-Chap02-ExH.html#t:CIN">CIN</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:CIN" class="def">CIN</a> = <a href="../base-4.9.1.0/Data-String.html#t:String">String</a> <a href="src/TFwH.Chap02.ExH.html#CIN" class="link">Source</a> <a href="#t:CIN" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:addSum" class="def">addSum</a> :: <a href="TFwH-Chap02-ExH.html#t:CIN">CIN</a> -&gt; <a href="TFwH-Chap02-ExH.html#t:CIN">CIN</a> <a href="src/TFwH.Chap02.ExH.html#addSum" class="link">Source</a> <a href="#v:addSum" class="selflink">#</a></p><div class="doc"><p>8&#26689;&#12398;ID&#12395;&#12481;&#12455;&#12483;&#12463;&#12469;&#12512;&#12434;&#36861;&#21152;&#12375;&#12390;10&#26689;&#12398;ID&#12395;&#12377;&#12427;
 <code>getDigit</code> &#12434;&#23450;&#32681;&#12379;&#12378;&#12395;&#65292;<code>Data.Char.digitToInt :: Char -&gt; Int</code> &#12434;&#20351;&#12356;&#12414;&#12375;&#12383;&#65294;
 &#21104;&#20313;&#35336;&#31639;&#12399;<code>div</code>&#12392;<code>mod</code>&#12434;&#21029;&#12293;&#12395;&#20351;&#12431;&#12378;&#65292;<code>divMod</code> &#12434;&#20351;&#12356;&#12414;&#12375;&#12383;&#65294;</p><pre>addSum :: CIN -&gt; CIN
addSum cin = cin ++ show q ++ show r
             where
               (q,r) = sum (map digitToInt cin) <code><a href="../base-4.9.1.0/Prelude.html#v:divMod">divMod</a></code> 10
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>addSum &quot;12345678&quot;
</code></strong>&quot;1234567836&quot;
</pre></div></div><div class="top"><p class="src"><a id="v:valid" class="def">valid</a> :: <a href="TFwH-Chap02-ExH.html#t:CIN">CIN</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/TFwH.Chap02.ExH.html#valid" class="link">Source</a> <a href="#v:valid" class="selflink">#</a></p><div class="doc"><p>&#35672;&#21029;&#30058;&#21495;&#12364;&#27491;&#12375;&#12356;&#12363;&#12393;&#12358;&#12363;&#12434;&#21028;&#23450;&#12377;&#12427;</p><p><code>Data.Char</code> &#12434;&#12452;&#12531;&#12509;&#12540;&#12488;&#12375;&#12390;&#12424;&#12426;&#32048;&#12363;&#12356;&#12481;&#12455;&#12483;&#12463;&#12434;&#23455;&#26045;</p><pre>valid :: CIN -&gt; Bool
valid cin = length cin == 10
         &amp;&amp; all isDigit cin
         &amp;&amp; cin == addSum (take 8 cin)
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valid &quot;123456&quot;
</code></strong>False
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valid &quot;abcd56789a4&quot;
</code></strong>False
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valid &quot;1234567890&quot;
</code></strong>False
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valid &quot;12345678036&quot;
</code></strong>False
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valid &quot;1234567836&quot;
</code></strong>True
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>