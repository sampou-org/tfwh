<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- = &#31532;2&#31456; &#32244;&#32722;&#21839;&#38988; H</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- </span><span>
</span><a name="line-4"></a><span class="hs-comment">--    * @addSum :: CIN -&gt; CIN@ &#12434;&#27083;&#25104;&#12379;&#12424;</span><span>
</span><a name="line-5"></a><span class="hs-comment">--</span><span>
</span><a name="line-6"></a><span class="hs-comment">--        @</span><span>
</span><a name="line-7"></a><span class="hs-comment">--        type CIN = String</span><span>
</span><a name="line-8"></a><span class="hs-comment">--</span><span>
</span><a name="line-9"></a><span class="hs-comment">--        addSum :: CIN -&gt; CIN</span><span>
</span><a name="line-10"></a><span class="hs-comment">--        addSum cin = cin ++ show (n `div` 10) ++ show (n `mod` 10)</span><span>
</span><a name="line-11"></a><span class="hs-comment">--                     where</span><span>
</span><a name="line-12"></a><span class="hs-comment">--                       n = sum (map getDigit cin)</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">--        getDigit :: Char -&gt; Int</span><span>
</span><a name="line-15"></a><span class="hs-comment">--        getDigit c = read [c]</span><span>
</span><a name="line-16"></a><span class="hs-comment">--        @</span><span>
</span><a name="line-17"></a><span class="hs-comment">--</span><span>
</span><a name="line-18"></a><span class="hs-comment">--    * &#35672;&#21029;&#30058;&#21495;&#12364;&#27491;&#12375;&#12356;&#12363;&#12393;&#12358;&#12363;&#12434;&#21028;&#23450;&#12377;&#12427;&#38306;&#25968; @valid :: CIN -&gt; Bool@ &#12434;&#27083;&#25104;&#12379;&#12424;</span><span>
</span><a name="line-19"></a><span class="hs-comment">--</span><span>
</span><a name="line-20"></a><span class="hs-comment">--        @</span><span>
</span><a name="line-21"></a><span class="hs-comment">--        valid :: CIN -&gt; Bool</span><span>
</span><a name="line-22"></a><span class="hs-comment">--        valid cin = cin == addSum (take 8 cin)</span><span>
</span><a name="line-23"></a><span class="hs-comment">--        @</span><span>
</span><a name="line-24"></a><span class="hs-comment">--</span><span>
</span><a name="line-25"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TFwH</span><span class="hs-operator">.</span><span class="hs-identifier">Chap02</span><span class="hs-operator">.</span><span class="hs-identifier">ExH</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">type</span><span> </span><a name="CIN"><a href="TFwH.Chap02.ExH.html#CIN"><span class="hs-identifier">CIN</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- 8&#26689;&#12398;ID&#12395;&#12481;&#12455;&#12483;&#12463;&#12469;&#12512;&#12434;&#36861;&#21152;&#12375;&#12390;10&#26689;&#12398;ID&#12395;&#12377;&#12427;</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- @getDigit@ &#12434;&#23450;&#32681;&#12379;&#12378;&#12395;&#65292;@Data.Char.digitToInt :: Char -&gt; Int@ &#12434;&#20351;&#12356;&#12414;&#12375;&#12383;&#65294;</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- &#21104;&#20313;&#35336;&#31639;&#12399;@div@&#12392;@mod@&#12434;&#21029;&#12293;&#12395;&#20351;&#12431;&#12378;&#65292;@divMod@ &#12434;&#20351;&#12356;&#12414;&#12375;&#12383;&#65294;</span><span>
</span><a name="line-35"></a><span class="hs-comment">--</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- addSum :: CIN -&gt; CIN</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- addSum cin = cin ++ show q ++ show r</span><span>
</span><a name="line-39"></a><span class="hs-comment">--              where</span><span>
</span><a name="line-40"></a><span class="hs-comment">--                (q,r) = sum (map digitToInt cin) `divMod` 10</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-42"></a><span class="hs-comment">--</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- &gt;&gt;&gt; addSum &quot;12345678&quot;</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- &quot;1234567836&quot;</span><span>
</span><a name="line-45"></a><span class="hs-comment">--</span><span>
</span><a name="line-46"></a><span class="hs-identifier">addSum</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TFwH.Chap02.ExH.html#CIN"><span class="hs-identifier hs-type">CIN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TFwH.Chap02.ExH.html#CIN"><span class="hs-identifier hs-type">CIN</span></a><span>
</span><a name="line-47"></a><a name="addSum"><a href="TFwH.Chap02.ExH.html#addSum"><span class="hs-identifier">addSum</span></a></a><span> </span><a name="local-6989586621679035675"><a href="#local-6989586621679035675"><span class="hs-identifier">cin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679035675"><span class="hs-identifier hs-var">cin</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679035676"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679035677"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-48"></a><span>             </span><span class="hs-keyword">where</span><span>
</span><a name="line-49"></a><span>               </span><span class="hs-special">(</span><a name="local-6989586621679035676"><a href="#local-6989586621679035676"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><a name="local-6989586621679035677"><a href="#local-6989586621679035677"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">digitToInt</span><span> </span><a href="#local-6989586621679035675"><span class="hs-identifier hs-var">cin</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">divMod</span><span class="hs-special">`</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- &#35672;&#21029;&#30058;&#21495;&#12364;&#27491;&#12375;&#12356;&#12363;&#12393;&#12358;&#12363;&#12434;&#21028;&#23450;&#12377;&#12427;</span><span>
</span><a name="line-53"></a><span class="hs-comment">--</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- @Data.Char@ &#12434;&#12452;&#12531;&#12509;&#12540;&#12488;&#12375;&#12390;&#12424;&#12426;&#32048;&#12363;&#12356;&#12481;&#12455;&#12483;&#12463;&#12434;&#23455;&#26045;</span><span>
</span><a name="line-55"></a><span class="hs-comment">--</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- valid :: CIN -&gt; Bool</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- valid cin = length cin == 10</span><span>
</span><a name="line-59"></a><span class="hs-comment">--          &amp;&amp; all isDigit cin</span><span>
</span><a name="line-60"></a><span class="hs-comment">--          &amp;&amp; cin == addSum (take 8 cin)</span><span>
</span><a name="line-61"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-62"></a><span class="hs-comment">--</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- &gt;&gt;&gt; valid &quot;123456&quot;</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- False</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- &gt;&gt;&gt; valid &quot;abcd56789a4&quot;</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- False</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- &gt;&gt;&gt; valid &quot;1234567890&quot;</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- False</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- &gt;&gt;&gt; valid &quot;12345678036&quot;</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- False</span><span>
</span><a name="line-71"></a><span class="hs-comment">-- &gt;&gt;&gt; valid &quot;1234567836&quot;</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-73"></a><span class="hs-comment">--</span><span>
</span><a name="line-74"></a><span class="hs-identifier">valid</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TFwH.Chap02.ExH.html#CIN"><span class="hs-identifier hs-type">CIN</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-75"></a><a name="valid"><a href="TFwH.Chap02.ExH.html#valid"><span class="hs-identifier">valid</span></a></a><span> </span><a name="local-6989586621679035678"><a href="#local-6989586621679035678"><span class="hs-identifier">cin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679035678"><span class="hs-identifier hs-var">cin</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-76"></a><span>         </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">all</span><span> </span><span class="hs-identifier hs-var">isDigit</span><span> </span><a href="#local-6989586621679035678"><span class="hs-identifier hs-var">cin</span></a><span>
</span><a name="line-77"></a><span>         </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679035678"><span class="hs-identifier hs-var">cin</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="TFwH.Chap02.ExH.html#addSum"><span class="hs-identifier hs-var">addSum</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679035678"><span class="hs-identifier hs-var">cin</span></a><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>         </span><span>
</span><a name="line-79"></a></pre></body></html>